{% extends 'default.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pages/password_reset_confirm.css' %}">
{% endblock %}

{% block navbar %}
    {% include "includes/navbars/minimal_navbar.html" %}
{% endblock %}

{% block content %}
<div class="verify-container">
  <div class="verify-box">
    <div class="text">–ß—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–ª–µ–¥—É–π—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º –Ω–∏–∂–µ.</div>

    <form method="post">
      {% csrf_token %}

      <div class="form-group" style="position: relative;">
        <label for="id_new_password1" class="form-label" >–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>

        <div class="password-wrapper">
          <input type="password" name="new_password1" id="id_new_password1"
                 class="form-input" autocomplete="new-password" required>
            <button type="button" class="password-toggle password-toggle--login" onclick="togglePassword('id_new_password1')">üëÅÔ∏è</button>
        </div>
          <small style="font-size: 12px; color: #777;">
                        –ù–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å ‚Äì –∑–∞–ª–æ–≥ –≤–∞—à–µ–π –∫—É–ª–∏–Ω–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!
          </small>
          <ul class="password-hints">
                <li id="length">–ù–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤</li>
                <li id="uppercase">–•–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞</li>
                <li id="digit">–•–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞</li>
                <li id="special">–•–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª (!@#$%^&*)</li>
            </ul>
      </div>

      <div class="form-group" style="position: relative;">
        <label for="id_new_password2" class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</label>

        <div class="password-wrapper">
        <input type="password" name="new_password2" id="id_new_password2"
                 class="form-input" autocomplete="new-password" required>
           <button type="button" class="password-toggle password-toggle--login" onclick="togglePassword('id_new_password2')">üëÅÔ∏è</button>

         </div>

          <div id="password-match-error" class="live-error"></div>
      </div>

      <button type="submit" class="btn submit-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</button>
    </form>
  </div>
</div>


<script>

  // ----- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è -----
    function togglePassword(inputId) {
        const passwordInput = document.getElementById(inputId);
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
    }

  document.addEventListener("DOMContentLoaded", () => {
    const p1 = document.getElementById("id_new_password1");
    const p2 = document.getElementById("id_new_password2");

    const hints = {
        length: document.getElementById("length"),
        uppercase: document.getElementById("uppercase"),
        digit: document.getElementById("digit"),
        special: document.getElementById("special"),
    };

    function validatePassword() {
      const v = p1.value;
      hints.length.classList.toggle("valid", v.length >= 8);
      hints.uppercase.classList.toggle("valid", /[A-Z–ê-–Ø–Å]/.test(v));
      hints.digit.classList.toggle("valid", /\d/.test(v));
      hints.special.classList.toggle("valid", /[!@#$%^&*]/.test(v));
    }

    function validateMatch() {
      const error = document.getElementById("password-match-error");
      error.textContent = (p1.value && p2.value && p1.value !== p2.value)
          ? "–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!"
          : "";
  }

   p1.addEventListener("input", () => { validatePassword(); validateMatch(); });
   p2.addEventListener("input", validateMatch);

});
</script>

{% endblock %}